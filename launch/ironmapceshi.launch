<!--xml-->
<launch>
    <param name="use_sim_time" value="true"/>

    <arg name="localpath" default="/home/machozhao/dataset"/>

    <node pkg="rosbag" type="play" name="rosbag" args="-r 1.0 -s 15
		$(arg localpath)/3_level02_ccw/kinect_ship_test3_1.bag
		$(arg localpath)/3_level02_ccw/kinect_ship_test3_2.bag
		$(arg localpath)/3_level02_ccw/kinect_ship_test3_3.bag  --clock ">
    </node>


    <node pkg="nodelet" type="nodelet" name="depth2cloud" args="standalone depth_image_proc/point_cloud_xyz">
        <remap from="/camera_info" to="/camera/depth_registered/camera_info"/>
        <remap from="/image_rect" to="/camera/depth_registered/image"/>
        <!-- <remap from="/camera_info" to="/camera/depth/camera_info"/>
      <remap from="/image_rect" to="/camera/depth/image"/> -->
        <remap from="points" to="/camera/depth/points2"/>
    </node>


    <!-- Random Sampling Filter : /random_sample_filter/cloud-->
    <!--node pkg="pcl_filtering" type="random_filter" name="random_filter" output="screen"
          args="input:=/camera/depth/points2" >
          <param name="sampleNum" value="4000" />
    </node-->

    

    <node pkg="hector_trajectory_server" type="hector_trajectory_server" name="hector_trajectory_server"
          output="screen">
        <param name="target_frame_name" type="string" value="/world"/>
        <param name="source_frame_name" type="string" value="/camera_rgb_optical_frame"/>
        <!-- <param name="source_frame_name" type="string" value="/openni_rgb_optical_frame" /> -->
        <param name="trajectory_update_rate" type="double" value="10"/>
        <param name="trajectory_publish_rate" type="double" value="10"/>
        <remap from="trajectory" to="/Trajectory"/>
    </node>

    <!-- Launch visualizaiton  -->
    <node pkg="rviz" type="rviz" name="rviz" args="-d $(find IRONMAP_loopclosure)/launch/icp.rviz"/> 


    <node pkg="tf" type="static_transform_publisher" name="actualmap_to_cloudmap"
          args="0.1 0.6 0.1 0.03 3.1 1.268 /world /map 100"/>

    <!-- Show actual map in rviz-->
    <node pkg="map_server" type="map_server" name="actual_map" args="$(find IRONMAP_loopclosure)/config/mapfiles/level2.yaml"/>

</launch>

